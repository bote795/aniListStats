<!DOCTYPE html>
<html lang="">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>anilist stat viewer</title>

		<!-- Bootstrap CSS -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

		<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
		<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
		<!--[if lt IE 9]>
			<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
			<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
		<![endif]-->
	</head>
	<body>
		<h1 class="text-center">anilist stat viewer</h1>
		<div class="row">
			<div class="col-md-offset-4 col-md-4">
				<div class="form-group">
					<label class="sr-only" for="">User Name</label>
					<input type="text" name="" id="username" class="form-control" placeholder="user name" required="required">
				</div>		
			<button id="target" type="submit" class="btn btn-primary">Submit</button>
			</div>
		</div>
		<div id="chart"></div>
		<!-- jQuery -->
		<script src="http://code.jquery.com/jquery.js"></script>
		<script src="http://d3js.org/d3.v3.min.js"></script>
		<script src="auth.js"></script>
		<script src="StorageHelper.js"></script>
		<script src="User.js"></script>
		<script src="Stats.js"></script>
		<script src="PieChart.js"></script>
		<script src="bundle.js"></script>
		<script type="text/javascript">
			function formatStaffName(item)
			{
				return item.name_first + " " + item.name_last; //+"  :\n "+ item.role;
			}
			$( "#target" ).click(function( event ) {
			  var username = $("#username").val();
			  window.anime(username).then(function(){

			  	//studio pie Chart
			  	var studios = [];
			  	var orderedStudios = Stats.getSortedMap("studio");
			  	for (var i = 0; i < 6; i++) {
			  		studios.push({label: Stats.studiosNamesMap.get(orderedStudios[i][0] ).studio_name, value: orderedStudios[i][1]});
			  	}
			  	var studioPieChart = new PieChart(studios);
			  	studioPieChart.draw();

			  	//staff pie chart
			  	var staff = [];
			  	var orderedStaff = Stats.getSortedMap("staff");
			  	for (var i = 0; i < 6; i++) {
			  		staff.push({label: formatStaffName(Stats.staffNamesMap.get(orderedStaff[i][0])), value: orderedStaff[i][1]});
			  	}
			  	var staffPieChart = new PieChart(staff);
			  	staffPieChart.draw();

			  	//genre pie chart
			  	var genre = [];
			  	var orderedGenre = Stats.getSortedMap("genres");
			  	for (var i = 0; i < 6; i++) {
			  		genre.push({label: orderedGenre[i][0], value: orderedGenre[i][1]});
			  	}
			  	var genrePieChart = new PieChart(genre);
			  	genrePieChart.draw();

			  });
			  event.preventDefault();
			});
		</script>
		<!-- Bootstrap JavaScript -->
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
	</body>
</html>